<!doctype html>
<html>
  <head>
    {% include head.liquid %}

    <!-- Distill js -->
    <script src="{{ '/assets/js/distillpub/template.v2.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/distillpub/transforms.v2.js' | relative_url }}"></script>
    <style>
      /* Improve caption contrast in dark mode */
      @media (prefers-color-scheme: dark) {
        .post.distill figcaption.caption,
        .post.distill .figure-caption {
          color: #e6e6e6 !important;
          opacity: 1 !important;
        }
      }
      body.dark .post.distill figcaption.caption,
      body.dark .post.distill .figure-caption {
        color: #e6e6e6 !important;
        opacity: 1 !important;
      }
    </style>
    {% if page._styles %}
      <!-- Page/Post style -->
      <style type="text/css">
        {{ page._styles }}
      </style>
    {% endif %}
  </head>

  <d-front-matter>
    <script async type="text/json">
      {
            "title": "{{ page.title }}",
            "description": "{{ page.description }}",
            "published": "{{ page.date | date: '%B %d, %Y' }}",
            "authors": [
              {% for author in page.authors %}
              {
                "author": "{{ author.name }}",
                "authorURL": "{{ author.url }}"
              }{% if forloop.last == false %},{% endif %}
              {% endfor %}
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script>
  </d-front-matter>

  <body class="{% if site.navbar_fixed %}fixed-top-nav{% endif %} {% unless site.footer_fixed %}sticky-bottom-footer{% endunless %}">
    <!-- Header -->

    <!-- Content -->
    <div class="post distill">
      <d-title>
        <h1>{{ page.title }}</h1>
        <p>{{ page.description }}</p>
        {% if page.authors %}
          {% assign has_affiliations = false %}
          {% for author in page.authors %}
            {% if author.affiliations %}
              {% assign has_affiliations = true %}
              {% break %}
            {% endif %}
          {% endfor %}
          {% unless has_affiliations %}
            <p class="author-names" style="font-size: 0.95rem; color: #666; margin-top: 1rem; font-family: Arial, sans-serif;">
              {% for author in page.authors %}
                {% if author.url %}
                  <a href="{{ author.url }}" style="color: inherit; text-decoration: underline; text-underline-offset: 2px;">{{ author.name }}</a>
                {% else %}
                  {{ author.name }}
                {% endif %}
                {% unless forloop.last %}&nbsp;&nbsp;{% endunless %}
              {% endfor %}
            </p>
          {% endunless %}
        {% endif %}
      </d-title>
      {% if page.authors and has_affiliations %}
        <d-byline></d-byline>
      {% endif %}
      {% if page.code_url or page.arxiv_url %}
      <div class="resource-links" style="margin: 0.25rem 0 1rem 0; display: flex; gap: 0.75rem; flex-wrap: wrap; justify-content: center;">
        {% if page.code_url %}
          <a href="{{ page.code_url }}" target="_blank" rel="noopener" style="display: inline-block; padding: 10px 18px; border-radius: 10px; background: #0d6efd; color: #fff; text-decoration: none; font-size: 1rem; font-weight: 600;">Code</a>
        {% endif %}
        {% if page.arxiv_url %}
          <a href="{{ page.arxiv_url }}" target="_blank" rel="noopener" style="display: inline-block; padding: 10px 18px; border-radius: 10px; background: #6c757d; color: #fff; text-decoration: none; font-size: 1rem; font-weight: 600;">Paper</a>
        {% endif %}
      </div>
      {% endif %}

      <d-article>
        {% if page.toc %}
          <d-contents>
            <nav class="l-text figcaption">
              <h3>Contents</h3>
              {% for section in page.toc %}
                <div>
                  <a href="#{{ section.name | slugify }}">{{ section.name }}</a>
                </div>
                {% if section.subsections %}
                  <ul>
                    {% for subsection in section.subsections %}
                      <li>
                        <a href="#{{ subsection.name | slugify }}">{{ subsection.name }}</a>
                      </li>
                    {% endfor %}
                  </ul>
                {% endif %}
              {% endfor %}
            </nav>
          </d-contents>
        {% endif %}
        {{ content }}
      </d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>

      <d-bibliography src="{{ page.bibliography | prepend: '/assets/bibliography/' | relative_url }}"></d-bibliography>
    </div>

    <!-- Footer -->
    {% include footer.liquid %}

    <!-- JavaScripts -->
    {% include distill_scripts.liquid %}
  </body>
</html>
